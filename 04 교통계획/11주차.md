### 로직 모형의 한계
선택되는 대안들은 독립적이어야함 : 마을버스 시내버스는 어떻게 봐야하나?  
가장 쉬운 방법은 1/n인데 승용차 레드버스 블루버스라면 첨에는 그냥 1/n하는데  
이성적으로 생각하면 색깔만 다른데 저런다고? 교집합이 어마어마할텐데? 아 이건아니다  
해서 먼저 크게 승용차와 버스라는 카테고리로 1/2씩 나누고 그 안에서 또 레드버스 블루버스 1/2씩 나누면 최종적으로 승용차 1/2, 레드버스 1/4, 블루버스 1/4  
P(A|B) : B를 끄집어내서 B안에서 이건 A고 이건 C라면 A를 요렇게 계산하는거 (조건부 확률) - 전체집합이 줄어들었기 때문에 확률이 전체보다 크게나옴  
P(레드버스) = P(레드버스|버스)P(버스) = 1/2 * 1/2 = 1/4

### 그래서 IIA solution : Nested Logit Model
앞에서 조건부확률 한거처럼 디시젼 트리처럼 만들어주는거  
실제로 알고자 하는 확률은 맨 밑단의 확률  
P(bus) = P(bus | transit) * P(transit)

EMU = log썸exp(V/phi) : phi는 스케일 파라매터 - 캘리브레이션 하는거 (범위는 0과 1사이)  
EMU : expected maximum utility  
phi가 1이나오면 Nested갈 필요 없고 멀티노미얼 로직 모형으로 가면 됨

### 책 242p
문제 7.3 숙제내준거에 대해서  
Vmt(대중교통)의 EMU에서 0.6 이 파이값 세타값이 되는거임  
Vcar = A, Vst = B, Vbus = C, Vsub = D  
P(bus) = P(bus | mt) * P(mt)  
주의 : 계산식에서 유틸리티 값 계산한다음 세타로 나눠줘야함

### VOT : Value of Time
새로운 도로를 건설했어 30분이 절약돼  
시간을 돈으로 나타내면 사람들이 효과를 더욱 체감할 수 있는것  
- 한계임금율법 : 월평균월급을 시간으로 나눠서 계산 - 업무통행/비업무통행
- 한계대체율법 : 유틸리티 함수 추정해 계산 시간 알파, 비용 베타, V_A = a * TIME + b * COST -> a/b = 비용당 시간

## 4단계
본격적으로 길찾기 놀이  
V는 볼륨, 교통량의 이니셜, Va는 링크a를 지나가는 교통량 : vph(시간당 차량 대수) 또는 pcu(차량 당 가중치까지 계산해서 승객으로 따지는 거)
C는 비용함수, 인자로 Va를 받음

### Cost-Flow Relationship
**q = uk 쿡**
- q : flow 대/시, 시간당 차량 대 수
- u : speed km/h
- k : density 대/km
k와 u는 반비례 관계  
차가 움직이지도 못해 = 혼잡하면 혼잡할 수록 -> q값이 줄어든다  
Kjam과 Uf(free flow)  
q와 k는 밥그릇 엎어둔 모습, 여기서 기울기는 속도  
혼잡은 수용량을 넘어가는 순간부터 혼잡이 발생함 : 밥그릇의 최고점 이후

### 꼭 알아야 하는 식 BPR function
Bureau of Public Roads (BPR) function : 코스트 펑션임  
Tf = To * (1 + a * (V/C)^b)  
- Tf는 final 트래블 시간
- To는 프리플로우일때 걸리는 시간
- 알파는 계수값, 베타도 계수값 (각각 디폴트가 0.15와 4)
- V는 실제 그 링크를 달리는 차량의 대수
- C는 링크의 수용량

신호등은 수용량을 줄임

